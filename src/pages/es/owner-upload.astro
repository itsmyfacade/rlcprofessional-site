---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Nav from "../../components/Nav.astro";
import site from "../../content/site.json";
import es from "../../i18n/es.json";
const url = new URL(Astro.request.url);
const key = url.searchParams.get("key") || "";
const allowed = key && key === import.meta.env.PUBLIC_OWNER_KEY;
---

<BaseLayout
  lang="es"
  title="Subida del Dueño | RLC Professional"
  description="Portal seguro para subir contenido."
  canonical={Astro.url.href}
  ogImage="/assets/og.jpg"
>
  <Nav t={es} site={site} lang="es" />

  <main class="mx-auto max-w-3xl px-4 py-12">
    <h1 class="text-2xl font-extrabold text-brand-900">Subida del Dueño</h1>
    <p class="mt-2 text-slate-700">
      Esta página es para que el dueño del negocio suba fotos/videos nuevos a la galería del sitio.
    </p>

    {allowed ? (
      <div class="mt-6 card">
        <p class="text-sm text-slate-700">
          Abra el formulario abajo. (Todavía necesitará la contraseña de Tally.)
        </p>

        <div class="mt-4 overflow-hidden rounded-2xl ring-1 ring-slate-200/60 bg-white">
          <iframe
            title="Formulario de Subida RLC"
            src={site.tallyFormUrlEs}
            loading="lazy"
            class="w-full"
            style="height: 78vh;"
            referrerpolicy="no-referrer"
          ></iframe>
        </div>
      </div>
    ) : (
      <div class="mt-6 rounded-2xl bg-white p-5 ring-1 ring-slate-200/60">
        <p class="text-sm font-semibold text-slate-800">
          Acceso denegado.
        </p>
        <p class="mt-1 text-sm text-slate-600">
          Use su enlace privado de dueño.
        </p>
      </div>
    )}
  </main>
</BaseLayout>